{
  "id": "103",
  "name": "LDAP Injection Test Case 2",
  "description": " The following vulnerable code is used in an ASP web application which provides login with an LDAP database.\r\n\r\nOn line 11, the variable userName is initialized and validated to check if itâ€™s not blank. Then, the content of this variable is used to construct an LDAP query used by SearchFilter on line 28. The attacker has the chance specify what will be queried on LDAP server, and see the result on the line 33 to 41; all results and their attributes are displayed.\r\n\r\nCommented vulnerable asp code:\r\n\r\n \r\n 1.\t<html>\r\n 2.\t<body>\r\n 3.\t<%@ Language=VBScript %>\r\n 4.\t<%\r\n 5.\tDim userName\r\n 6.\tDim filter\r\n 7.\tDim ldapObj\r\n 8.\t\t\r\n 9.\tConst LDAP_SERVER = \"ldap.example\"\r\n 10.\t\r\n 11.\tuserName = Request.QueryString(\"user\")\r\n 12.\t\r\n 13.\tif( userName = \"\" ) then\r\n 14.\tResponse.Write(\"Invalid request. Please specify a valid\r\n 15.\tuser name\")\r\n 16.\tResponse.End()\r\n 17.\tend if\r\n 18.\t\r\n 19.\tfilter = \"(uid=\" + CStr(userName) + \")\" ' searching for the  user entry \r\n 20.\t\r\n 21.\t'Creating the LDAP object and setting the base dn\r\n 22.\tSet ldapObj = Server.CreateObject(\"IPWorksASP.LDAP\")\r\n 23.\tldapObj.ServerName = LDAP_SERVER\r\n 24.\tldapObj.DN = \"ou=people,dc=spilab,dc=com\"\r\n 25.\t\r\n 26.\t'Setting the search filter\r\n 27.\tldapObj.SearchFilter = filter\r\n 28.\t\r\n 29.\tldapObj.Search\r\n 30.\t\r\n 31.\t'Showing the user information\r\n 32.\tWhile ldapObj.NextResult = 1\r\n 33.\tResponse.Write(\"<p>\")\r\n 34.\t\r\n 35.\tResponse.Write(\"<b><u>User information for: \" + \r\n 36.\tldapObj.AttrValue(0) + \"</u></b><br>\")\r\n 37.\tFor i = 0 To ldapObj.AttrCount -1\r\n 38.\tResponse.Write(\"<b>\" + ldapObj.AttrType(i) +\"</b>: \" +\r\n 39.\tldapObj.AttrValue(i) + \"<br>\" )\r\n 40.\tNext\r\n 41.\tResponse.Write(\"</p>\")\r\n 42.\tWend\r\n 43.\t%>\r\n 44.\t</body>\r\n 45.\t</html>   \r\n\r\nIn the example above, we send the * character in the user parameter which will result in the filter variable in the code to be initialized with (uid=*). The resulting LDAP statement will make the server return any object that contains a uid attribute like username.\r\n\r\n http://www.some-site.org/index.asp?user=*  \r\n\r\n\r\nReference: https://www.owasp.org/index.php/LDAP_injection",
  "labels": "OWASP",
  "libraryId": "1",
  "guid": "f7d85811-3b4d-4906-a51d-13cf9bc5a21d",
  "isHidden": false,
  "isReadOnlyLibraryEntity": false,
  "libraryGuid": "eef7dcf9-53bd-48e9-849d-21445ebad101"
}