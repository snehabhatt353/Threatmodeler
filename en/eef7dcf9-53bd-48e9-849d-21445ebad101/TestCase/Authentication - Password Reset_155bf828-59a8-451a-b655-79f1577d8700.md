{
  "id": "45",
  "name": "Authentication - Password Reset",
  "description": "The first step is to check whether secret questions are used. Sending the password (or a password reset link) to the user email address without first asking for a secret question means relying 100% on the security of that email address, which is not suitable if the application needs a high level of security.\nOn the other hand, if secret questions are used, the next step is to assess their strength.\nAs a first point, how many questions need to be answered before the password can be reset? The majority of applications only need the user to answer to one question, but some critical applications require the user to answer correctly to two or even more questions.\nAs a second step, we need to analyze the questions themselves. Often a self-reset system offers the choice of multiple questions; this is a good sign for the would-be attacker as this presents him/her with options. Ask yourself whether you could obtain answers to any or all of these questions via a simple Google search on the Internet or with a social engineering attack. As a penetration tester, here is a step-by-step walk-through of assessing a password self-reset tool:\n\n    Are there multiple questions offered?\n        If so, try to pick a question which would have a “public” answer; for example, something Google would find with a simple query\n        Always pick questions which have a factual answer such as a “first school” or other facts which can be looked up\n        Look for questions which have few possible options, such as “what make was your first car”. These questions would present the attacker with a short-list of answers to guess at and based on statistics the attacker could rank answers from most to least likely \n    Determine how many guesses you have (if possible)\n        Does the password reset allow unlimited attempts?\n        Is there a lockout period after X incorrect answers? Keep in mind that a lockout system can be a security problem in itself, as it can be exploited by an attacker to launch a Denial of Service against legitimate users \n    Pick the appropriate question based on analysis from above point, and do research to determine the most likely answers\n    How does the password-reset tool (once a successful answer to a question is found) behave?\n        Does it allow immediate change of the password?\n        Does it display the old password?\n        Does it email the password to some pre-defined email address?\n        The most insecure scenario here is if the password reset tool shows you the password; this gives the attacker the ability to log into the account, and unless the application provides information about the last login the victim would not know that his/her account has been compromised.\n        A less insecure scenario is if the password reset tool forces the user to immediately change his/her password. While not as stealthy as the first case, it allows the attacker to gain access and locks the real user out.\n        The best security is achieved if the password reset is done via an email to the address the user initially registered with, or some other email address; this forces the attacker to not only guess at which email account the password reset was sent to (unless the application tells that) but also to compromise that account in order to take control of the victim's access to the application. \n\n\nThe key to successfully exploiting and bypassing a password self-reset is to find a question or set of questions which give the possibility of easily acquiring the answers. Always look for questions which can give you the greatest statistical chance of guessing the correct answer, if you are completely unsure of any of the answers. In the end, a password self-reset tool is only as strong as the weakest question. As a side note, if the application sends/visualizes the old password in cleartext it means that passwords are not stored in a hashed form, which is a security issue in itself. ",
  "labels": "",
  "libraryId": "1",
  "guid": "155bf828-59a8-451a-b655-79f1577d8700",
  "isHidden": false,
  "isReadOnlyLibraryEntity": false,
  "libraryGuid": "eef7dcf9-53bd-48e9-849d-21445ebad101"
}