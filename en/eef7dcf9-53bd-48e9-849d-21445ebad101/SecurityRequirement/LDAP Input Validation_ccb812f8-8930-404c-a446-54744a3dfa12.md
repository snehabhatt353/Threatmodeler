{
  "id": "90",
  "name": "LDAP Input Validation",
  "description": "<p>Assume all input is malicious. Use an appropriate combination of black lists and white lists to neutralize LDAP syntax from user-controlled input. LDAP Injection is an attack used to exploit web based applications that construct LDAP statements based on user input. When an application fails to properly sanitize user input, it's possible to modify LDAP statements through techniques similar to SQL Injection.</p><p /><ol></ol><div><br /></div><div>LDAP injection attacks are common due to two factors:</div><ol></ol><p /><p>LDAP injection attacks could result in the granting of permissions to unauthorized queries, and content modification inside the LDAP tree.</p><ol><li>The lack of safer, parameterized LDAP query interfaces</li><li>The widespread use of LDAP to authenticate users to systems.</li></ol><p /><div>Primary Defenses:</div><div>Escape all variables using the right LDAP encoding function</div><div><br /></div><div>Additional Defenses:</div><div>Use a framework (like LINQtoAD) that escapes automatically.</div><p /><p><br /></p><p><b>Implementation:</b></p><p>Option 1: Escape all variables using the right LDAP encoding function</p><p>The main way LDAP stores names is based on DN (distinguished name). You can think of this like a unique identifier. These are sometimes used to access resources, like a username.</p><p>A DN might look like this</p><p>cn=Richard Feynman, ou=Physics Department, dc=Caltech, dc=edu</p><p>or</p><p>uid=inewton, ou=Mathematics Department, dc=Cambridge, dc=com</p><p>There are certain characters that are considered special characters in a DN.</p><p>The exhaustive list is the following: \\ # + &lt; &gt; , ; &quot; = and leading or trailing spaces.</p><p>Some &quot;special&quot; characters that are allowed in Distinguished Names and do not need to be escaped include:</p><p>* ( ) . &amp; - _ [ ] ` ~ | @ $ % ^ ? : { } ! '</p><p><br /></p><p>Option 2: Use Frameworks that Automatically Protect from LDAP Injection</p><p>Safe NET Example</p><p>LINQ to Active Directory provides automatic LDAP encoding when building LDAP queries.</p><p><br /></p><p>Option 3: Additional Defenses</p><p>Beyond adopting one of the two primary defenses, we also recommend adopting all of these additional defenses in order to provide defense in depth. These additional defenses are:</p><ul><li>Least Privilege</li><li>White List Input Validation</li></ul><p>Least Privilege</p><p>To minimize the potential damage of a successful LDAP injection attack, you should minimize the privileges assigned to the LDAP binding account in your environment.</p><p>White List Input Validation</p><p>Input validation can be used to detect unauthorized input before it is passed to the LDAP query. For more information please see the Input Validation Cheat Sheet.</p><p><br /></p><p>Reference:</p><p><a href=\"https://cheatsheetseries.owasp.org/cheatsheets/LDAP_Injection_Prevention_Cheat_Sheet.html\" target=\"_blank\">https://cheatsheetseries.owasp.org/cheatsheets/LDAP_Injection_Prevention_Cheat_Sheet.html</a></p>",
  "labels": "ThreatModeler,AppSec and InfraSec,Web Applcation,Native Application,Thick Client,TM-504,Web Application,Web Service,Third Party Web Service",
  "libraryId": "1",
  "isHidden": false,
  "guid": "ccb812f8-8930-404c-a446-54744a3dfa12",
  "riskId": 2,
  "isCompensatingControl": false,
  "riskName": "High",
  "isReadOnlyLibraryEntity": false,
  "lastUpdated": "2021-11-18T20:27:13.387",
  "libraryGuid": "eef7dcf9-53bd-48e9-849d-21445ebad101"
}