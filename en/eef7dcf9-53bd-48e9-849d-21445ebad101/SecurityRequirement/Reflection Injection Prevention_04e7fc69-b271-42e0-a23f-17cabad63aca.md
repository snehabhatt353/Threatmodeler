{
  "id": "98",
  "name": "Reflection Injection Prevention",
  "description": "<p>An adversary supplies a value to the target application which is then used by reflection methods to identify a class, method, or field. For example, in the Java programming language the reflection libraries permit an application to inspect, load, and invoke classes and their components by name. If an adversary can control the input into these methods including the name of the class/method/field or the parameters passed to methods, they can cause the targeted application to invoke incorrect methods, read random fields, or even to load and utilize malicious classes that the adversary created. This can lead to the application revealing sensitive information, returning incorrect results, or even having the adversary take control of the targeted application.</p><p>Reflection is an API which is used to examine or modify the behavior of methods, classes, interfaces at runtime.</p><p>• The required classes for reflection are provided under java.lang.reflect package.</p><p>• Reflection gives us information about the class to which an object belongs and also the methods of that class which can be executed by using the object.</p><p>• Through reflection we can invoke methods at runtime irrespective of the access specifier used with them.Reflection can be used to get information about –</p><ol><li>Class The getClass() method is used to get the name of the class to which an object belongs.</li><li>Constructors The getConstructors() method is used to get the public constructors of the class to which an object belongs.</li><li>Methods The getMethods() method is used to get the public methods of the class to which an objects belongs.</li></ol><p><br /></p><p><b>Implementation:</b></p><p>1. We can invoke an method through reflection if we know its name and parameter types. We use below two methods for this purpose</p><p>getDeclaredMethod() : To create an object of method to be invoked. The syntax for this method is</p><p>Class.getDeclaredMethod(name, parametertype)</p><p>name- the name of method whose object is to be created</p><p>parametertype - parameter is an array of Class objects</p><p>invoke() : To invoke a method of the class at runtime we use following method–</p><p>Method.invoke(Object, parameter)</p><p>If the method of the class doesn’t accepts any parameter then null is passed as argument.</p><p>2. Through reflection we can access the private variables and methods of a class with the help of its class object and invoke the method by using the object as discussed above. We use below two methods for this purpose. </p><p>Class.getDeclaredField(FieldName) : Used to get the private field. Returns an object of type Field for specified field name.</p><p>Field.setAccessible(true) : Allows to access the field irrespective of the access modifier used with the field.</p><p>Avoid using external input to generate reflection string values.</p><p><br /></p><p><b>Reference:</b></p><p><a href=\"https://www.geeksforgeeks.org/reflection-in-java/\" target=\"_blank\">https://www.geeksforgeeks.org/reflection-in-java/</a></p><p><a href=\"https://capec.mitre.org/data/definitions/138.html\" target=\"_blank\">https://capec.mitre.org/data/definitions/138.html</a></p>",
  "labels": "ThreatModeler,AppSec and InfraSec,Web Application,Native Application,JAVA,ASP.NET Core,TM-12",
  "libraryId": "1",
  "isHidden": false,
  "guid": "04e7fc69-b271-42e0-a23f-17cabad63aca",
  "riskId": 2,
  "isCompensatingControl": false,
  "riskName": "High",
  "isReadOnlyLibraryEntity": false,
  "lastUpdated": "2021-08-10T18:02:13.33",
  "libraryGuid": "eef7dcf9-53bd-48e9-849d-21445ebad101"
}