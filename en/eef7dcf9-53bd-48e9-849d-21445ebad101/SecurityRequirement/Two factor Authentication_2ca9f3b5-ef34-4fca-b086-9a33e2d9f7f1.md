{
  "id": "22",
  "name": "Two factor Authentication",
  "description": "<p>Two-Factor Authentication (2FA) is when a user is required to present more than one type of evidence in order to authenticate on a system. There are four different types of evidence (or factors) that can be used in different combinations: <br /></p><ul><li>\nSomething you know (Passwords, PINs and security questions) </li><li>Something you have (Hardware or software tokens, certificates, email, SMS and phone calls)\n</li><li>Something you are (Fingerprints, facial recognition, and handprint scans)\n</li><li>Location (Source IP ranges and geolocation)\n</li></ul><p>It should be emphasised that while requiring multiple examples of a single factor (such as needing both a password and a PIN) does not constitute 2FA, although it may provide some security benefits over a simple password. \n</p><p>\nThe most common way that user accounts get compromised on applications is through weak, re-used or stolen passwords. As developers or system administrators, it should be assumed that users' passwords will be compromised as some point, and the system should be designed in order to defend against this. </p><p>\nTwo-Factor Authentication (2FA) is by far the best defense against the majority of password-related attacks, including brute-force, credential stuffing and password spraying, with analysis by Microsoft suggesting that it would have stopped 99.9% of account compromises. </p><p><b>The following recommendations are generally appropriate for most applications, and provide an initial starting point to consider:\n</b></p><p><b>\n1. When is 2FA Required </b></p><p>2FA is required everytime the user logs in. However, depending on the functionality available, it may also be appropriate to require 2FA for performing sensitive actions, such as:\n</p><ul><li>\nChanging passwords or security questions. </li><li>Changing the email address associated with the account.\n</li><li>Disabling 2FA.\n</li><li>Elevating a user session to an administrative session.\n</li></ul><p><b>\n2. Improving Usability </b></p><p>Having to frequently login with 2FA creates an additional burden for users and may cause them to disable 2FA on the application. A number of mechanisms can be used to try and reduce the level of annoyance that 2FA causes, such as:\n</p><ul><li>\nRemembering the user's browser so they don't need to use 2FA every time. </li><li>This can either be permanent, or for a period of a few days.\n</li><li>This needs to be done with more than just a cookie, which could be stolen by an attacker.\n</li><li>Whitelisting corporate IP ranges (or, more strictly, using location as a second factor).\n</li><li>Only requiring 2FA for sensitive actions, not for the initial login.</li></ul><p><b>3. Failed Login Attempts </b></p><p>When a user enters their password, but fails to authenticate using a second factor. There are a number of steps that should be taken when this occurs:\n</p><p>\n</p><ul><li>Prompt the user to try another form of 2FA\n</li><li>Allow the user to attempt to reset their 2FA.\n</li><li>Notify the user of the failed login attempt and encourage them to change their password if they do not recognize it.\n</li><li>This should be displayed next time they login, and optionally emailed to them as well.\n</li></ul><p>\n</p><p><b>4. Resetting 2FA\n</b></p><p>One of the biggest challenges with implementing MFA is handling users who forget or lose their second factors. There are many ways this could happen, such as:\n</p><p>\n</p><ul><li>Re-installing a workstation without backing up digital certificates.\n</li><li>Wiping or losing a phone without backing up OTP codes.\n</li><li>Changing mobile numbers.\n</li></ul><p>\n</p><p>In order to prevent users from being locked out of the application, there needs to be a mechanism for them to regain access to their account if they can't use their existing 2FA, such as:\n</p><ul><li>Providing the user with a number of single-use recovery codes when they first setup 2FA.\n</li><li>Requiring the user to setup multiple types of 2FA (such as a digital certificate, OTP core and phone number for SMS), so that they are unlikely to lose access to all of them at once.\n</li><li>Posting a one-use recovery code (or new hardware token) to the user.\n</li><li>Requiring the user contact the support team and having a rigorous process in place to verify their identity.\n</li><li>Requiring another trusted user to vouch for them.</li></ul><p>Resource:<br /></p><p><a href=\"https://cheatsheetseries.owasp.org/cheatsheets/Multifactor_Authentication_Cheat_Sheet.html\" target=\"_blank\">https://cheatsheetseries.owasp.org/cheatsheets/Multifactor_Authentication_Cheat_Sheet.html</a></p><p><br /></p>",
  "labels": "ThreatModeler,AppSec and InfraSec,Account,Single Sign On,OAuth,TM-114",
  "libraryId": "1",
  "isHidden": false,
  "guid": "2ca9f3b5-ef34-4fca-b086-9a33e2d9f7f1",
  "riskId": 2,
  "isCompensatingControl": false,
  "riskName": "High",
  "isReadOnlyLibraryEntity": false,
  "lastUpdated": "2020-09-22T18:32:34.233",
  "libraryGuid": "eef7dcf9-53bd-48e9-849d-21445ebad101"
}