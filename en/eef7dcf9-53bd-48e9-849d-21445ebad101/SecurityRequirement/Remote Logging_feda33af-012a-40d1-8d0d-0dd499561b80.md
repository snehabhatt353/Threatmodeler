{
  "id": "93",
  "name": "Remote Logging",
  "description": "<p>Implement an audit log that is written to a separate host, in the event of a compromise the audit log may be able to provide evidence and details of the compromise.</p><p>Standard system log management configuration rotates log files every week and retains them for four rotations. It is often desirable to maintain logs longer than the four-week default, especially when establishing system performance trends related to tasks, such as month-end financial closings, which are executed just once a month. By sending log messages to a remote log host with dedicated mass storage, administrators can maintain large archives of system logs for their systems without changing the default log rotation configuration, which is intended to keep logs from overconsuming disk storage.</p><p>Central collection of system log messages can also be very useful for monitoring the state of systems and for quickly identifying problems. It also provides a backup location for log messages in case a system suffers a catastrophic hard drive failure or other problems, which cause the local logs to no longer be available. In these situations, the copy of the log messages which reside on the central log host can be used to help diagnose the issue that caused the problem.</p><p>Standardized system logging is implemented in Red Hat Enterprise Linux 7 by the rsyslog service. System programs can send syslog messages to the local rsyslogd service, which will then redirect those messages to files in /var/log, remote log servers, or other databases based on the settings in its configuration file, /etc/rsyslog.conf.</p><p><br /></p><p><b>Implementation:</b></p><p>The implementation of a central log host requires the configuration of the rsyslog service on two types of systems: the remote systems where the log messages originate from and the central log host receiving the messages. On the central log host, the rsyslog service needs to be configured so that log messages from remote hosts are accepted.</p><p>To configure the rsyslog service on the central log host to accept remote logs, uncomment either the TCP or UDP reception lines in the modules section in the /etc/rsyslog.conf file.</p><p>For UDP reception:</p><p># Provides UDP syslog reception</p><p>$ModLoad imudp.so</p><p>$UDPServerRun 514</p><p>for TCP reception:</p><p># Provides TCP syslog reception</p><p>$ModLoad imtcp.so</p><p>$InputTCPServerRun 514</p><p>TCP provides more reliable delivery of remote log messages, but UDP is supported by a wider variety of operating systems and networking devices.</p><p>Templates are defined in /etc/rsyslog.conf and can be used to generate rules with dynamic log file names. A template definition consists of the $template directive, followed by a template name, and then a string representing the template text. The template text can be made dynamic by making use of values substituted from the properties of a log message. For example, to direct cron syslog messages from different systems to different files on a central log host, use the following template to generate dynamic log file names based on the HOSTNAME property of each message:</p><p>$template DynamicFile,&quot;/var/log/loghost/%HOSTNAME%/cron.log&quot;</p><p>The dynamic file name created using the template definition can then be referenced by the template name in a rule as follows:</p><p>cron.*    ?DynamicFile</p><p><br /></p><p><b>Reference:</b></p><p><a target=\"_blank\" href=\"https://www.thegeekdiary.com/configuring-remote-logging-using-rsyslog-in-centos-rhel/\">https://www.thegeekdiary.com/configuring-remote-logging-using-rsyslog-in-centos-rhel/</a></p>",
  "labels": "ThreatModeler,AppSec and InfraSec,VOIP Server,SSH Server,File Server,FTP Server,Key Management Server,Email Server,OAuth Server,Web Server,Bare Metal Server,Virtual Server,Proxy Server,VPN Server,Jump Server,Database,Host,TM-617",
  "libraryId": "1",
  "isHidden": false,
  "guid": "feda33af-012a-40d1-8d0d-0dd499561b80",
  "riskId": 2,
  "isCompensatingControl": false,
  "riskName": "High",
  "isReadOnlyLibraryEntity": false,
  "lastUpdated": "2021-08-09T16:58:02.857",
  "libraryGuid": "eef7dcf9-53bd-48e9-849d-21445ebad101"
}