{
  "id": "76",
  "name": "Server Side Security Check",
  "description": "<p>For any security checks that are performed on the client side, ensure that these checks are duplicated on the server side. </p><p><b>Web Server Security and Database Server Security</b></p><p>Various high-profile hacking attacks have proven that web security remains the most critical issue to any business that conducts its operations online. Web servers are one of the most targeted public faces of an organization, because of the sensitive data they usually host. Securing a web server is as important as securing the website or web application itself and the network around it. If you have a secure web application and an insecure web server, or vice versa, it still puts your business at a huge risk. Your company’s security is as strong as its weakest point.</p><p>Although securing a web server can be a daunting operation and requires specialist expertise, it is not an impossible task. Long hours of research and an overdose of coffee and take away food, can save you from long nights at the office, headaches and data breaches in the future. Irrelevant of what web server software and operating system you are running, an out of the box configuration is usually insecure. Therefore one must take some necessary steps in order to increase web server security. Below is a list of tasks one should follow when securing a web server.</p><p>1. Remove Unnecessary Services</p><p>2. Remote access</p><p>3. Separate development / testing / production environment</p><p>4 .Web application content and server-side scripting</p><p>5. Permissions and privileges</p><p>6. Install all security patches on time</p><p>7. Monitor and audit the server</p><p>8. User accounts</p><p>9. Remove all unused modules and application extensions</p><p>10. Use security tools provided with web server software</p><p>11. Stay informed</p><p>12. Use Scanners</p><p><br /></p><p><b>Implementation:</b></p><p>This example contains client-side code that checks if the user authenticated successfully before sending a command. The server-side code performs the authentication in one step, and executes the command in a separate step.</p><p>CLIENT-SIDE (client.pl)</p><p>$server = &quot;server.example.com&quot;;</p><p>$username = AskForUserName();</p><p>$password = AskForPassword();</p><p>$address = AskForAddress();</p><p>$sock = OpenSocket($server, 1234);</p><p>writeSocket($sock, &quot;AUTH $username $password\\n&quot;);</p><p>$resp = readSocket($sock);</p><p>if ($resp eq &quot;success&quot;) {# username/pass is valid, go ahead and update the info! </p><p>writeSocket($sock, &quot;CHANGE-ADDRESS $username $address\\n&quot;;</p><p>}</p><p>else {</p><p>print &quot;ERROR: Invalid Authentication!\\n&quot;;</p><p>}</p><p>Server _Side (Server.pl)</p><p>$sock = acceptSocket(1234);</p><p>($cmd, $args) = ParseClientRequest($sock);</p><p>if ($cmd eq &quot;AUTH&quot;) {</p><p>($username, $pass) = split(/\\s+/, $args, 2);</p><p>$result = AuthenticateUser($username, $pass);</p><p>writeSocket($sock, &quot;$result\\n&quot;);</p><p># does not close the socket on failure; assumes the # user will try again </p><p>}</p><p>elsif ($cmd eq &quot;CHANGE-ADDRESS&quot;) {</p><p>if (validateAddress($args)) {</p><p>$res = UpdateDatabaseRecord($username, &quot;address&quot;, $args);</p><p>writeSocket($sock, &quot;SUCCESS\\n&quot;);</p><p>}</p><p>else {</p><p>writeSocket($sock, &quot;FAILURE -- address is malformed\\n&quot;);</p><p>}</p><p>}</p><p>The server accepts 2 commands, &quot;AUTH&quot; which authenticates the user, and &quot;CHANGE-ADDRESS&quot; which updates the address field for the username. The client performs the authentication and only sends a CHANGE-ADDRESS for that user if the authentication succeeds. Because the client has already performed the authentication, the server assumes that the username in the CHANGE-ADDRESS is the same as the authenticated user. An attacker could modify the client by removing the code that sends the &quot;AUTH&quot; command and simply executing the CHANGE-ADDRESS.</p><p><br /></p><p><b>Reference:</b></p><p><a target=\"_blank\" href=\"https://www.acunetix.com/websitesecurity/webserver-security/\">https://www.acunetix.com/websitesecurity/webserver-security/</a></p><p><a target=\"_blank\" href=\"https://cwe.mitre.org/data/definitions/602.html\">https://cwe.mitre.org/data/definitions/602.html</a></p>",
  "labels": "ThreatModeler,AppSec and InfraSec,SSH Server,File Server,FTP Server,OAuth Server,JUMP Server,Web Application,Web Server,TM-8",
  "libraryId": "1",
  "isHidden": false,
  "guid": "0290def0-b709-48f6-8b6e-524d9ebcfe94",
  "riskId": 2,
  "isCompensatingControl": false,
  "riskName": "High",
  "isReadOnlyLibraryEntity": false,
  "lastUpdated": "2021-08-09T14:29:32.107",
  "libraryGuid": "eef7dcf9-53bd-48e9-849d-21445ebad101"
}